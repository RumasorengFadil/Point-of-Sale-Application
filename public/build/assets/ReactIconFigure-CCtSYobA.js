import{j as a,r as v}from"./app-XxkfEPqk.js";import{R as q}from"./index-CU0r19-m.js";import{e as R,d as P}from"./react-C2hb0JWP.js";import{c as A}from"./index-lJenEdQh.js";import{L as B}from"./LabelWithIcon-BjcrBKSo.js";import{P as E}from"./PrimaryButton-DUTAuk1W.js";import{d as k}from"./index-BDAfdCTm.js";import{f as b}from"./formatNumberWithDots-Do-x_jmg.js";import{G as F}from"./iconBase-CB2dzOmW.js";function M({className:e="",title:t="Kembali",onClick:n,hidden:s=!1,hiddenIcon:o=!1,iconClassName:r,...c}){return a.jsxs("div",{className:`flex items-center space-x-2 ${e} ${s?"hidden":""}`,children:[a.jsx(R,{...c,onClick:n,className:`cursor-pointer ${r}`,size:24}),a.jsx("p",{className:"font-medium",children:t})]})}function Q(e,t){let n;try{n=e()}catch{return}return{getItem:o=>{var r;const c=d=>d===null?null:JSON.parse(d,void 0),i=(r=n.getItem(o))!=null?r:null;return i instanceof Promise?i.then(c):c(i)},setItem:(o,r)=>n.setItem(o,JSON.stringify(r,void 0)),removeItem:o=>n.removeItem(o)}}const I=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(s){return I(s)(n)},catch(s){return this}}}catch(n){return{then(s){return this},catch(s){return I(s)(n)}}}},_=(e,t)=>(n,s,o)=>{let r={storage:Q(()=>localStorage),partialize:l=>l,version:0,merge:(l,g)=>({...g,...l}),...t},c=!1;const i=new Set,d=new Set;let u=r.storage;if(!u)return e((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...l)},s,o);const h=()=>{const l=r.partialize({...s()});return u.setItem(r.name,{state:l,version:r.version})},m=o.setState;o.setState=(l,g)=>{m(l,g),h()};const p=e((...l)=>{n(...l),h()},s,o);o.getInitialState=()=>p;let y;const w=()=>{var l,g;if(!u)return;c=!1,i.forEach(f=>{var x;return f((x=s())!=null?x:p)});const N=((g=r.onRehydrateStorage)==null?void 0:g.call(r,(l=s())!=null?l:p))||void 0;return I(u.getItem.bind(u))(r.name).then(f=>{if(f)if(typeof f.version=="number"&&f.version!==r.version){if(r.migrate){const x=r.migrate(f.state,f.version);return x instanceof Promise?x.then(C=>[!0,C]):[!0,x]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,f.state];return[!1,void 0]}).then(f=>{var x;const[C,$]=f;if(y=r.merge($,(x=s())!=null?x:p),n(y,!0),C)return h()}).then(()=>{N==null||N(y,void 0),y=s(),c=!0,d.forEach(f=>f(y))}).catch(f=>{N==null||N(void 0,f)})};return o.persist={setOptions:l=>{r={...r,...l},l.storage&&(u=l.storage)},clearStorage:()=>{u==null||u.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>w(),hasHydrated:()=>c,onHydrate:l=>(i.add(l),()=>{i.delete(l)}),onFinishHydration:l=>(d.add(l),()=>{d.delete(l)})},r.skipHydration||w(),y||p},z=_,j=P(z((e,t)=>({cart:[],handleAddToCart:n=>{const{cart:s}=t(),o=s.find(r=>r.id===n.id);e(o?{cart:s.map(r=>r.id===n.id?{...r,quantity:r.quantity+1}:r)}:{cart:[...s,{id:n.id,quantity:1}]})},handleIncreaseQty:n=>{e({cart:t().cart.map(s=>s.id===n?{...s,quantity:s.quantity+1}:s)})},handleDecreaseQty:n=>{e({cart:t().cart.map(s=>s.id===n&&s.quantity>1?{...s,quantity:s.quantity-1}:s)})},handleDestroyFromCart:n=>{e({cart:t().cart.filter(s=>s.id!==n)})},handleClearCart:()=>e({cart:[]})}),{name:"cart-store",storage:{getItem:e=>{const t=sessionStorage.getItem(e);return t?JSON.parse(t):null},setItem:(e,t)=>{sessionStorage.setItem(e,JSON.stringify(t))},removeItem:e=>sessionStorage.removeItem(e)}})),H=({message:e,icon:t,className:n})=>a.jsxs("div",{className:`flex flex-col items-center justify-center text-center p-4 ${n}`,children:[t&&a.jsx("div",{className:"mb-2",children:t}),a.jsx("p",{className:"text-gray-200",children:e})]});function O({label:e="Button",onClick:t=()=>{},className:n="",summary:s=0,children:o,...r}){return a.jsx(E,{...r,onClick:t,className:"rounded py-2 px-4 flex w-full items-center justify-between bg-primary cursor-pointer shadow-md+ "+n,children:o||a.jsxs(a.Fragment,{children:[a.jsxs("h1",{className:"font-bold text-white",children:["Rp. ",s]}),a.jsx(B,{direction:"row-reverse",label:e,icon:A,iconSize:20})]})})}const J=P(e=>({paidAmount:"",setPaidAmount:t=>e({paidAmount:t})})),K=(e,t)=>{if(typeof e!="number"||typeof t!="number")throw new Error("Price and discount must be numbers.");if(e<0||t<0||t>100)throw new Error("Price must be non-negative and discount must be between 0 and 100.");return e*t/100},S=(e,t)=>{if(!Array.isArray(e))throw new Error("Parameter pertama harus berupa array.");return e.find(s=>s.id===t)||null},L=(e=[],t=[])=>{const n=J(i=>i.paidAmount),s=v.useMemo(()=>t.reduce((i,d)=>{const u=S(e,d.id);return u?i+u.price*d.quantity:i},0),[e,t]),o=v.useMemo(()=>t.reduce((i,d)=>{const u=S(e,d.id);return u?i+K(Number(u.price),Number(u.discount))*d.quantity:i},0),[e,t]),r=v.useMemo(()=>s-o,[s,o]),c=v.useMemo(()=>n-r,[n,r]);return{subtotal:s,discount:o,total:r,paidAmount:n,change:c}};function T(e){return F({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 4c-4.419 0-8 3.582-8 8s3.581 8 8 8 8-3.582 8-8-3.581-8-8-8zm3.707 10.293c.391.391.391 1.023 0 1.414-.195.195-.451.293-.707.293s-.512-.098-.707-.293l-2.293-2.293-2.293 2.293c-.195.195-.451.293-.707.293s-.512-.098-.707-.293c-.391-.391-.391-1.023 0-1.414l2.293-2.293-2.293-2.293c-.391-.391-.391-1.023 0-1.414s1.023-.391 1.414 0l2.293 2.293 2.293-2.293c.391-.391 1.023-.391 1.414 0s.391 1.023 0 1.414l-2.293 2.293 2.293 2.293z"},child:[]}]})(e)}function G({active:e=!1,className:t="",quantity:n,onIncrease:s,onDecrease:o}){return a.jsxs("div",{className:`flex items-center ${t}`,children:[a.jsx("div",{onClick:o,className:"flex text-xl cursor-pointer items-center justify-center w-7 h-7 bg-primary rounded-full text-white",children:"-"}),a.jsx("div",{className:"",children:n}),a.jsx("div",{onClick:s,className:"flex text-xl cursor-pointer items-center justify-center w-7 h-7 bg-primary rounded-full text-white",children:"+"})]})}const U=({price:e=0,className:t})=>a.jsx("div",{className:"flex flex-col",children:a.jsxs("span",{className:`${t}`,children:["Rp. ",e]})}),W=({discountedPrice:e,className:t})=>a.jsxs("span",{className:t,children:["Rp. ",e]}),X=({src:e,alt:t})=>a.jsx("div",{className:"w-16 h-16",children:a.jsx("img",{className:"w-full h-full rounded",src:e,alt:t})}),Y=({product:e,cart:t,onIncrease:n,onDecrease:s})=>a.jsxs("div",{className:"flex flex-1 space-x-2",children:[a.jsxs("div",{className:"flex flex-col space-y-5 text-sm w-full",children:[a.jsx("p",{children:e.name}),a.jsx(G,{quantity:t.quantity,onIncrease:n,onDecrease:s,className:"space-x-16 lg:space-x-4"})]}),a.jsx("div",{className:"flex flex-col text-sm justify-between w-full items-end",children:a.jsxs("div",{children:[a.jsx(U,{className:e.discount?"line-through":"font-semibold",price:e.price}),e.discount>0&&a.jsx(W,{className:"font-semibold",discountedPrice:e.discountedPrice})]})})]}),Z=({onDelete:e})=>a.jsx(T,{onClick:e,className:"text-gray-400 cursor-pointer",size:15}),V=v.memo(({cart:e,product:t})=>{const n=j(h=>h.handleDecreaseQty),s=j(h=>h.handleIncreaseQty),o=j(h=>h.handleDestroyFromCart),r=`/storage/uploads/POS/img/products/${t.image}`,c=t.name,i=()=>o(t.id),d=()=>s(e.id),u=()=>n(e.id);return a.jsxs("div",{className:"flex w-full py-4 px-4 shadow-md+ rounded space-y-3 space-x-2",children:[a.jsx(X,{src:r,alt:c}),a.jsx(Y,{cart:e,product:t,onIncrease:d,onDecrease:u}),a.jsx(Z,{onDelete:i})]})}),ee=({id:e,name:t,image:n,price:s,discount:o},r=c=>c)=>{if(typeof r!="function")throw new Error("setData must be a function");const c=s-s*o/100,i={id:e,name:t,image:n,price:s,discount:o,discountedPrice:c};return{...i,...r(i)}},D=P(e=>({showCart:!1,setShowCart:t=>e({showCart:t})})),de=v.memo(function({products:t,buttonSummary:n=!0}){const s=D(m=>m.showCart),o=D(m=>m.setShowCart),r=j(m=>m.cart),c=j(m=>m.handleClearCart),{total:i}=L(t,r),d=()=>a.jsx(H,{className:"h-full items-center w-full",message:"Keranjang Kosong"}),u=()=>a.jsx("div",{className:"flex flex-col w-full h-full space-y-2 mb-12 overflow-auto",children:r.map(m=>{const p=S(t,m.id);if(p)return a.jsx(V,{cart:m,product:ee(p,({price:y,discountedPrice:w})=>({price:b(y*m.quantity),discountedPrice:b(w*m.quantity)}))},m.id)})}),h=()=>a.jsx("div",{className:"flex flex-col w-full z-50",children:a.jsx(O,{label:"bayar",summary:b(i),disabled:!r.length,onClick:()=>k.Inertia.get(route("transaction.create"))})});return a.jsxs("div",{className:`${s?"-translate-x-0":"translate-x-full"} flex fixed top-0 transition-all w-full space-y-4 flex-col py-4 px-4 items-start h-full min-w-60 bg-white overflow-y-auto lg:py-0 lg:static lg:translate-x-0`,children:[a.jsxs("div",{className:"flex w-full items-center justify-between",children:[a.jsx(M,{onClick:()=>o(!s),title:"Keranjang",iconClassName:"lg:hidden"}),a.jsx(q,{onClick:c,className:"cursor-pointer",size:20})]}),r.length?u():d(),n&&h()]})}),te=({caption:e,className:t,children:n,size:s="xs",isSelected:o=!1,classNameIfTrue:r="",classNameIfFalse:c="",align:i="center"})=>a.jsx("figcaption",{className:`text-${i} text-${s} ${t} ${o?r:c}`,children:n||e}),me=({reactIcon:e,figCaption:t="",className:n,children:s,captionSize:o="xs",isSelected:r=!1,classNameIfTrue:c="",classNameIfFalse:i=""})=>a.jsxs("figure",{className:`flex flex-col space-y-2 ${n} ${r?c:i}`,children:[e&&e,s||a.jsx(te,{size:o,caption:t,align:"left"})]});export{M as B,de as C,W as D,U as P,me as R,j as a,L as b,K as c,O as d,D as e,S as f,ee as g,J as u};
